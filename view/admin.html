{{template "layout.html" .}}

{{define "title"}}Admin - DRASL{{end}}

{{define "content"}}

{{template "header" .}}

<h4>Pending Invites</h4>

<div style="text-align: right;">
	<form style="all: unset !important" action="{{.App.FrontEndURL}}/drasl/admin/new-invite" method="post">
		<input hidden name="returnUrl" value="{{.URL}}">
		<input type="submit" value="+ New Invite">
	</form>
</div>
<table>
	<thead>
		<tr>
			<td style="width: 50%">Link</td>
			<td>Date Generated</td>
			<td></td>
		</tr>
	</thead>
	<tbody>
		{{ range $invite := .Invites }}
			<tr>
				<td>
					<a href="{{ $.App.FrontEndURL }}/drasl/registration?invite={{ $invite.Code }}">{{ $.App.FrontEndURL }}/drasl/registration?invite={{ $invite.Code }}</a>
				</td>
				<td>
					{{ $invite.CreatedAt.Format "Mon Jan _2 15:04:05 MST 2006" }}
				</td>
				<td>
					<form action="{{ $.App.FrontEndURL }}/drasl/admin/delete-invite" method="post">
						<input hidden name="returnUrl" value="{{ $.URL }}">
						<input type="text" name="inviteCode" value="{{ $invite.Code }}" hidden/>
						<input type="submit" value="ðŸ—™ Delete" />
					</form>
				</td>
			</tr>
		{{ end }}
	</tbody>
</table>

<h4>All Users</h4>

<div style="display: none;">
{{ range $entry := .UserEntries }}
	<form id="delete-{{ $entry.User.Username }}" action="{{ $.App.FrontEndURL }}/drasl/admin/delete-user" method="post" onsubmit="return confirm('Are you sure? This action is irreversible.');">
		<input hidden name="returnUrl" value="{{ $.URL }}">
		<input type="text" name="username" value="{{ $entry.User.Username }}"></input>
	</form>
{{ end }}
</div>

<form action="{{.App.FrontEndURL}}/drasl/admin/update-users" method="post">
	<table>
		<thead>
			<tr>
				<td></td>
				<td>Username</td>
				<td>Player Name</td>
				<td>Admin</td>
				<td>Locked</td>
				<!-- <td>Delete Account</td> -->
			</tr>
		</thead>
		<tbody>
			{{ range $entry := .UserEntries }}
				<tr>
					<td style="width: 30px;"><div class="list-profile-picture" style="background-image: url({{$entry.SkinURL}});"></div>
					<td><a href="{{ $.App.FrontEndURL }}/drasl/profile?user={{ $entry.User.Username }}">{{ $entry.User.Username }}</a></td>
					<td>{{ $entry.User.PlayerName }}</td>
					<td><input name="admin-{{ $entry.User.Username }}" title="Admin?" type="checkbox" {{ if $entry.User.IsAdmin }}checked{{ end }}/></td>
					<td><input name="locked-{{ $entry.User.Username }}" title="Locked?" type="checkbox" {{ if $entry.User.IsLocked }}checked{{ end }}/></td>
					<!-- <td><input type="submit" form="delete-{{ $entry.User.Username }}" value="Delete" ></td> -->
				</tr>
			{{ end }}
		</tbody>
	</table>
	<p style="text-align: center;">
		<input hidden name="returnUrl" value="{{ $.URL }}">
		<input type="submit" value="Save Changes">
	</p>
</form>

{{end}}
